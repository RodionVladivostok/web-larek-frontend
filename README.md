# Проектная работа "Веб-ларек"

https://github.com/RodionVladivostok/web-larek-frontend.git

Стек: HTML, SCSS, TS, Webpack - ок

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

Приложение "Веб-ларек" выполнено в MVP-архитектуре (Model-View-Presenter) с применением брокера событий

# "СЛОЙ МОДЕЛЬ" (Model)

1. Класс AppState - отвечает за состояние приложения.

Содержит следующие поля: 
- catalog: IProduct[] = [] - массив товаров на странице;
- basket: IProduct[] = [] - массив товаров, сложенных в корзину;
-	payment: TPayment = null - способ оплаты, по умолчанию не выбран;
-	address = '' - адрес доставки, по умолчанию не заполнен;
-	email = '' - эл. почта, по умолчанию не заполнена;
-	phone = '' - номер телефона, по умолчанию не заполнен;

Содержит следующие методы:
-	setCatalog(products: IProduct[]) - метод получения массива данных (карточек) с сервера;
- addToBasket(value: IProduct) - метод добавления позиции товара в корзину;
- deleteFromBasket(id: string) - метод удаления позиции товара из корзины;
- get basketCount() - геттер, который возвращает количество товаров в корзине;
-	clearBasket() - метод очистки корзины;
-	get basketSum() - геттер, который возвращает сумму товаров в корзине;
-	getProduct(id: string) - метод получения карточки товара из массива;
-	isProductInBasket(id: string) - метод проверки наличия карточки товара в корзине;
-	get isPhoneAndEmailValid() - геттер, который возвращает результат проверки (валидации) одновременного заполнения инпутов эл. почты и номера телефона;
-	get isPaymentAndAddressValid() - геттер, который возвращает результат проверки (валидации) одновременного выбора способа оплаты и заполнения инпута адреса доставки;
-	clearOrderAndContactFields() - метод очистки инпутов адреса доставки, номера телефона и эл. почты, а также приведения способа оплаты в статус по умолчаниию (т.е. "не выбран");

# "СЛОЙ ПРЕДСТАВЛЕНИЯ" (View)

1. Класс Basket - отвечает за отображение окна корзины товаров.

Содержит следующие поля: 
-	protected _basketList: HTMLUListElement - список товаров в корзине;
-	protected _basketPrice: HTMLSpanElement - общая сумма товаров в корзине;
-	protected _basketButton: HTMLButtonElement - кнопка "Оформить";

Содержит следующие методы:
- set basketItems(basketItems: HTMLElement[]) - сеттер, отвечающий за отображение товаров в корзине;
- set basketSum(sum: number) - сеттер, отвечающий за отображение суммы товаров в корзине;
- updateIndexes() - метод обновления порядковых номеров товаров в корзине в случае удаления отдельных позиций;

2. Класс BasketItem - отвечает за отображение отдельной позиции товара в окне корзины.

Содержит следующие поля: 
-	protected _title: HTMLSpanElement - наименование товара;
-	protected _price: HTMLSpanElement - цена товара;
-	protected _index: HTMLSpanElement - порядковый номер товара;
-	protected _itemDeleteButton: HTMLButtonElement - кнопка-иконка "Удалить";
-	protected _id: string - идентификатор товара;

Содержит следующие методы:
-	set product(product: IProduct) - сеттер, отвечающий за отображение наименования товара, отображение цены товара, за идентификатор товара;
-	set index(value: number) - сеттер, отвечающий за отображение порядкового номера товара;

3. Класс Contacts - отвечает за отображение окна контактной информации - эл. почты и номера телефона.

Содержит следующие поля: 
-	protected _emailInput: HTMLInputElement - инпут для эл. почты;
-	protected _phoneInput: HTMLInputElement - инпут для номера телефона;
-	protected _payButton: HTMLButtonElement - кнопка "Оплатить";

Содержит следующие методы:
-	set email(value: string) - сеттер, отвечающий за отображение эл. почты;
- set phone(value: string) - сеттер, отвечающий за отображение номера телефона;
- set isFormValid(value: boolean) - сеттер, отвечающий за деактивацию кнопки "Оплатить" в случае, если форма не прошла валидацию (т.е. один из инпутов эл. почты и номера телефона не был заполнен);

4. Класс Gallery - отвечает за отображения всех карточек на странице.

Содержит следующие методы:
-	set catalog(items: HTMLElement[]) - сеттер, отвечающий за отображение всех карточек на странице;

5. Класс Modal - отвечает за отображение общего (универсального) модального окна или модального окна-контейнера, внутри которого отображается содержание всех остальных модальных окон: корзины, оформления заказа с выбором способа оплаты, контактной информации и успешного заказа.

Содержит следующие поля: 
-	protected _content: HTMLElement - контент внутри модального окна-контейнера;
-	protected _closeButton: HTMLButtonElement - кнопка закрытия "Крестик";

Содержит следующие методы:
-	set content(value: HTMLElement) - сеттер, отвечающий за отображение контента внутри модального окна-контейнера;
-	close() - метод закрытия модального окна-контейнера;
-	render(data?: Partial<IModal>): HTMLElement - метод отображения модального окна-контейнера;

6. Класс Order - отвечает за отображение окна оформления заказа.

Содержит следующие поля: 
-	protected _cardPayment: HTMLButtonElement - способ оплаты "Онлайн";
-	protected _cashPayment: HTMLButtonElement - способ оплаты "При получении";
-	protected _addressInput: HTMLInputElement - инпут для адреса доставки;
-	protected _orderBtn: HTMLButtonElement - кнопка "Далее";

Содержит следующие методы:
-	set _payment(payment: TPayment) - сеттер, отвечающий за установку способа оплаты; 
-	set address(value: string) - сеттер, отвечающий за отображение адреса доставки;
- set isFormValid(value: boolean) - сеттер, отвечающий за деактивацию кнопки "Далее" в случае, если форма не прошла валидацию (т.е. не выбран способ оплаты или не заполнен инпут адреса доставки);

7. Класс Page - отвечает за отображение главной страницы, включая header и все карточки.

Содержит следующие поля: 
-	protected _basketCount: HTMLSpanElement - счетчик товаров возле кнопки-иконки "Корзина";
-	protected _pageWrapper: HTMLDivElement - контейнер для содержимого главной страницы;
-	protected _basketButton: HTMLButtonElement - кнопка-иконка "Корзина";

Содержит следующие методы:
-	set basketCount(value: number) - сеттер, отвечающий за отображение количества товаров возле кнопки-иконки "Корзина";
-	set locked(value: boolean) - сеттер, отвечающий за блокирование скроллинга на главной странице после открытия модального окна или его разблокирование после закрытия модального окна;

7. Класс ProductCard - отвечает за отображение каждой отдельной карточки товара на главной странице.

Содержит следующие поля: 
-	protected _title: HTMLHeadElement - наименование товара;
-	protected _image: HTMLImageElement - картинка товара;
-	protected _price: HTMLSpanElement - цена товара;
-	protected _category: HTMLSpanElement - категория товара;
-	protected _id: string - идентификатор товара;

Содержит следующие методы:
-	set id(value: string) - сеттер, отвечающий за идентификатор товара;
-	set title(value: string) - сеттер, отвечающий за отображение наименования товара;
-	set price(value: number|null) - сеттер, отвечающий за отображение цены товара;
-	set image(value: string) - сеттер, отвечающий за отображение картинки товара;
-	set category(value: TCategory) - сеттер, отвечающий за отображение категории товара;

8. Класс ProductCardPreview - отвечает за отображение окна с подробным описанием выбранной карточки товара.

Содержит следующие поля: 
-	protected _category: HTMLSpanElement - категория товара;
-	protected _title: HTMLHeadElement - наименование товара;
-	protected _image: HTMLImageElement - картинка товара;
-	protected _price: HTMLSpanElement - цена товара;
-	protected _description: HTMLParagraphElement - описание товара;
-	protected _cardButton: HTMLButtonElement - кнопка "В корзину";
-	protected _id: string - идентификатор товара;

Содержит следующие методы:
-	set id(value: string) - сеттер, отвечающий за идентификатор товара;
-	set description(value: string) - сеттер, отвечающий за отображение описания товара;
-	set image(value: string) - сеттер, отвечающий за отображение картинки товара;
-	set title(value: string) - сеттер, отвечающий за отображение наименования товара;
-	set price(value: number|null) - сеттер, отвечающий за отображение цены товара;
-	set category(value: TCategory) - сеттер, отвечающий за отображение категории товара;
-	set inBasket(value: boolean) - сеттер, отвечающий за деактивацию кнопки "В корзине" в случае, если данный товар уже находится в корзине;

9. Класс Success - отвечает за отображение окна успешного оформления заказа.

Содержит следующие поля: 
-	protected _description: HTMLParagraphElement - описание общей суммы заказа, например, "Списано 1450 синапсов";
-	protected _successBtn: HTMLButtonElement - кнопка "За новыми покупками!";

Содержит следующие методы:
-	set sum(sum: number) - сеттер, отвечающий за отображение общей суммы заказа;

# "СЛОЙ ПРЕЗЕНТЕРА" (Presenter)
Код презентера не выделен в отдельный класс, а размещён в основном скрипте приложения (src/index.ts). Применяется событийно-ориентированный подход путем использования брокера событий.

1. Класс EventEmitter - реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков о наступлении события. Класс имеет методы on, off, emit — для подписки на событие, отписки от события и уведомления подписчиков о наступлении события, соответственно.

Перечень событий в приложении:

- 'catalog:changed' - событие срабатывает после получения с сервера массива данных (карточек) и приводит к их рендеру на главной страницце;
- 'basket:order' - событие срабатывает после клика по кнопке "Оформить" и приводит к рендеру модального окна оформлени заказа;
- 'card:delete-item' - событие срабатывает после клика по кнопке-иконке "Удалить" в модальном окне корзины, приводит к удалению позиции товара по идентификатору, к обновлению общей суммы, обновлению порядковых номеров товаров в корзине и обновлению счётика на кнопке-иконке "Корзина" на главной странице;
- 'email:changed' - событие срабатывает после ввода текста в инпуте для эл. почты в модальном окне с контактной информацией и приводит к валидации формы;
- 'phone:changed' - событие срабатывает после ввода текста в инпуте для номера телефона в модальном окне с контактной информацией и приводит к валидации формы;
- 'order:create' - событие срабатывает после клика по кнопке "Оплатить" в модальном окне с контактной информацией, приводит к созданию заказа на сервере, затем к рендеру модального окна успешного оформления заказа с указанием общей суммы, к очистке корзины, обнулению счетчика на кнопке-иконке "Корзина" на главной странице, очистке полей с контактной информацией, адресом доставки, приведению способа оплаты в статус "не выбран" и к деактивации кнопок "Далее" и "Оплатить" при повторном заказе;
- 'modal:close' - событие срабатывает после клика по кнопке закрытия "Крестик", по области за модальным окном или по кнопке "За новыми покупками!" и приводит к закрытию модального окна и к разблокированию скроллинга главной страницы;
- 'payment:change' - событие срабатывает после клика по кнопке "Онлайн" или "При получении" модального окна оформления заказа и приводит к валидации формы;
- 'address:changed' - событие срабатывает после ввода текста в инпуте для адреса доставки модального окна оформления заказа и приводит к валидации формы;
- 'basket:contacts' - событие срабатывает после клика по кнопке "Далее" модального окна оформления заказа и приводит к рендеру модального окна с контактной информацией;
- 'basket:open' - событие срабатывает после клика по кнопке-иконке "Корзина" на главной странице и приводит к рендеру модального окна корзины и к блокированию скроллинга главной страницы;
- 'card:select' - событие срабатывает после клика по одной из карточек товара на главной странице и приводит к рендеру модального окна с подробным описанием товара и к блокированию скроллинга главной страницы;
- 'card:to-basket' - событие срабатывает после клика по кнопке "В корзину" модального окна с подробным описанием товара и приводит к добавлению товара в корзину, к обновлению счётчика на кнопке-иконке "Корзина" на главной странице, к закрытию модального окна и к разблокированию скроллинга главной страницы.